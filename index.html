<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AgroVetor - Inspeção e Planeamento</title>

    <!-- PWA (Progressive Web App) Tags -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#2e7d32">
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
      :root {
          --color-primary: #2e7d32;
          --color-primary-dark: #1b5e20;
          --color-primary-light: #e8f5e9;
          --color-accent: #4caf50;
          --color-bg: #f5f5f5;
          --color-surface: #ffffff;
          --color-text: #333333;
          --color-text-light: #555555;
          --color-white: #ffffff;
          --color-border: #e0e0e0;
          --shadow-light: 0 2px 4px rgba(0,0,0,0.1);
          --shadow-medium: 0 4px 8px rgba(0,0,0,0.15);
          --border-radius: 8px;
      }

      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: 'Poppins', sans-serif;
      }

      body {
          background-color: var(--color-bg);
          color: var(--color-text);
          -webkit-font-smoothing: antialiased;
          display: flex;
          height: 100vh;
          overflow: hidden;
      }

      .container {
          display: flex;
          width: 100%;
      }

      .sidebar {
          width: 260px;
          background-color: var(--color-primary);
          color: var(--color-white);
          display: flex;
          flex-direction: column;
          padding: 1.5rem 1rem;
          transition: width 0.3s ease;
      }
      
      .sidebar.collapsed {
          width: 80px;
      }

      .sidebar-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 2rem;
      }

      .logo {
          font-size: 1.5rem;
          font-weight: 700;
          display: flex;
          align-items: center;
          gap: 0.5rem;
      }

      .logo i {
          font-size: 2rem;
      }
      
      .logo-text {
        white-space: nowrap;
      }

      .sidebar.collapsed .logo-text {
        display: none;
      }

      #toggle-sidebar-btn {
          background: none;
          border: none;
          color: var(--color-white);
          font-size: 1.5rem;
          cursor: pointer;
      }

      .nav-menu {
          list-style: none;
          flex-grow: 1;
      }

      .nav-item {
          margin-bottom: 0.5rem;
      }

      .nav-link {
          display: flex;
          align-items: center;
          padding: 0.9rem 1rem;
          color: var(--color-white);
          text-decoration: none;
          border-radius: var(--border-radius);
          transition: background-color 0.3s ease;
          white-space: nowrap;
      }

      .nav-link:hover, .nav-link.active {
          background-color: var(--color-primary-dark);
      }

      .nav-link i {
          font-size: 1.2rem;
          margin-right: 1rem;
          width: 24px;
          text-align: center;
      }
      
      .sidebar.collapsed .nav-link span {
        display: none;
      }
      
      .sidebar.collapsed .nav-link i {
        margin-right: 0;
      }

      .user-profile {
          padding-top: 1rem;
          border-top: 1px solid rgba(255, 255, 255, 0.2);
          display: flex;
          flex-direction: column;
      }
      
      .sidebar.collapsed .user-profile .user-info,
      .sidebar.collapsed .user-profile #logout-btn span {
        display: none;
      }

      .user-info {
          display: flex;
          align-items: center;
          margin-bottom: 1rem;
      }

      .user-avatar {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          background-color: var(--color-accent);
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: 600;
          margin-right: 0.75rem;
      }
      
      .sidebar.collapsed .user-avatar {
        margin-right: 0;
      }

      .user-details h4 {
          font-size: 0.9rem;
          font-weight: 600;
          margin: 0;
      }

      .user-details p {
          font-size: 0.8rem;
          opacity: 0.8;
          margin: 0;
      }

      #logout-btn {
          background: none;
          border: none;
          color: var(--color-white);
          display: flex;
          align-items: center;
          padding: 0.75rem 1rem;
          text-align: left;
          width: 100%;
          font-size: 1rem;
          cursor: pointer;
          border-radius: var(--border-radius);
          transition: background-color 0.3s ease;
      }

      #logout-btn:hover {
          background-color: var(--color-primary-dark);
      }

      #logout-btn i {
          margin-right: 1rem;
          font-size: 1.2rem;
      }
      
      .sidebar.collapsed #logout-btn i {
        margin-right: 0;
      }

      .main-content {
          flex-grow: 1;
          padding: 2rem;
          overflow-y: auto;
          height: 100vh;
      }

      .content-section {
          display: none;
      }

      .content-section.active {
          display: block;
      }

      .page-header {
          margin-bottom: 2rem;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }

      .page-header h1 {
          font-size: 2rem;
          font-weight: 600;
      }
      
      .header-actions {
        display: flex;
        gap: 1rem;
      }

      .btn, .btn-primary, .btn-secondary, .btn-danger {
          padding: 0.75rem 1.5rem;
          border: none;
          border-radius: var(--border-radius);
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.3s ease;
          text-decoration: none;
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
      }

      .btn-primary {
          background-color: var(--color-primary);
          color: var(--color-white);
      }

      .btn-primary:hover {
          background-color: var(--color-primary-dark);
      }
      
      .btn-secondary {
        background-color: #e0e0e0;
        color: var(--color-text);
      }
      
      .btn-secondary:hover {
        background-color: #bdbdbd;
      }

      .btn-danger {
        background-color: #d32f2f;
        color: var(--color-white);
      }

      .btn-danger:hover {
        background-color: #c62828;
      }

      .card {
          background-color: var(--color-surface);
          border-radius: var(--border-radius);
          box-shadow: var(--shadow-light);
          padding: 1.5rem;
          margin-bottom: 1.5rem;
      }
      
      .table-container {
          overflow-x: auto;
      }

      table {
          width: 100%;
          border-collapse: collapse;
          background-color: var(--color-surface);
      }

      th, td {
          padding: 1rem;
          text-align: left;
          border-bottom: 1px solid var(--color-border);
          font-size: 0.9rem;
      }

      th {
          font-weight: 600;
          background-color: var(--color-primary-light);
          color: var(--color-primary-dark);
      }

      tbody tr:hover {
          background-color: #f9f9f9;
      }

      .actions-cell button {
          background: none;
          border: none;
          cursor: pointer;
          color: var(--color-text-light);
          font-size: 1.1rem;
          margin-right: 0.75rem;
          transition: color 0.2s;
      }

      .actions-cell button:hover {
          color: var(--color-primary);
      }

      .actions-cell button.delete-btn:hover {
          color: #d32f2f;
      }
      
      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
      }

      .form-group {
          display: flex;
          flex-direction: column;
      }

      .form-group label {
          margin-bottom: 0.5rem;
          font-weight: 500;
          font-size: 0.9rem;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--color-border);
          border-radius: var(--border-radius);
          font-size: 0.9rem;
          background-color: #fff;
      }
      
      .form-group textarea {
        resize: vertical;
        min-height: 100px;
      }

      .form-actions {
          margin-top: 1.5rem;
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
      }

      /* Login Screen */
      #login-screen {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: var(--color-bg);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
      }

      .login-container {
          width: 100%;
          max-width: 400px;
          padding: 3rem;
          background-color: var(--color-surface);
          border-radius: var(--border-radius);
          box-shadow: var(--shadow-medium);
          text-align: center;
      }

      .login-container h1 {
          font-size: 2rem;
          font-weight: 700;
          color: var(--color-primary);
          margin-bottom: 0.5rem;
      }

      .login-container p {
          color: var(--color-text-light);
          margin-bottom: 2rem;
      }
      
      .login-container .form-group {
        text-align: left;
      }

      #login-form .btn-primary {
          width: 100%;
          margin-top: 1rem;
      }

      #forgot-password-link {
          display: block;
          margin-top: 1rem;
          color: var(--color-primary);
          text-decoration: none;
          font-size: 0.9rem;
      }
      
      #forgot-password-link:hover {
        text-decoration: underline;
      }

      #login-error {
          color: #d32f2f;
          margin-top: 1rem;
          font-size: 0.9rem;
          display: none;
      }
      
      /* Main App Container */
      #app-container {
        display: none; /* Hidden until user logs in */
      }

      /* Modal Styles */
      .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.6);
          display: none;
          align-items: center;
          justify-content: center;
          z-index: 500;
          animation: fadeIn 0.3s ease;
      }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      .modal-content {
          background-color: var(--color-surface);
          padding: 2rem;
          border-radius: var(--border-radius);
          width: 90%;
          max-width: 500px;
          box-shadow: var(--shadow-medium);
          animation: slideIn 0.3s ease-out;
      }
      
      @keyframes slideIn {
        from { transform: translateY(-30px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          border-bottom: 1px solid var(--color-border);
          padding-bottom: 1rem;
          margin-bottom: 1.5rem;
      }

      .modal-header h2 {
          font-size: 1.5rem;
          font-weight: 600;
      }

      .modal-close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: var(--color-text-light);
      }

      .modal-footer {
          margin-top: 2rem;
          padding-top: 1.5rem;
          border-top: 1px solid var(--color-border);
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
      }
      
      /* Dashboard Styles */
      .dashboard-module-selection {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .module-card {
        background: var(--color-surface);
        border-radius: var(--border-radius);
        padding: 2rem;
        text-align: center;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        box-shadow: var(--shadow-light);
      }

      .module-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-medium);
      }

      .module-card i {
        font-size: 3rem;
        color: var(--color-primary);
        margin-bottom: 1rem;
      }

      .module-card h3 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .module-card p {
        color: var(--color-text-light);
        font-size: 0.9rem;
      }

      .dashboard-module-view {
          display: none; /* Hidden by default */
      }
      
      .dashboard-module-view.active {
          display: block;
      }
      
      .dashboard-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .dashboard-header .back-btn {
        font-size: 1.2rem;
        padding: 0.5rem 0.8rem;
      }

      .dashboard-header h2 {
        font-size: 1.8rem;
        font-weight: 600;
      }
      
      .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
          gap: 1.5rem;
      }

      .chart-container {
          background-color: var(--color-surface);
          padding: 1.5rem;
          border-radius: var(--border-radius);
          box-shadow: var(--shadow-light);
          position: relative;
      }
      
      .chart-container h3 {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 1rem;
        text-align: center;
      }

      .expand-chart-btn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: none;
        border: none;
        color: var(--color-text-light);
        cursor: pointer;
        font-size: 1.2rem;
      }
      
      #chartModal .modal-content {
        max-width: 90vw;
        height: 80vh;
        display: flex;
        flex-direction: column;
      }
      #expandedChartContainer {
        flex-grow: 1;
        position: relative;
      }
      #expandedChartCanvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100% !important;
        height: 100% !important;
      }

      /* Spinner/Loading */
      .spinner-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(255, 255, 255, 0.8);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 9999;
      }

      .spinner {
          border: 4px solid rgba(0, 0, 0, 0.1);
          width: 36px;
          height: 36px;
          border-radius: 50%;
          border-left-color: var(--color-primary);
          animation: spin 1s ease infinite;
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }
      
      /* Responsive */
      @media (max-width: 768px) {
          body {
              flex-direction: column;
          }
          .sidebar {
              width: 100%;
              height: auto;
              flex-direction: row;
              align-items: center;
              padding: 0.5rem 1rem;
              position: fixed;
              bottom: 0;
              left: 0;
              z-index: 100;
              box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
              background-color: var(--color-primary);
          }
          .sidebar.collapsed {
            width: 100%;
          }
          .sidebar-header, .user-profile {
            display: none;
          }
          .nav-menu {
            display: flex;
            justify-content: space-around;
            width: 100%;
          }
          .nav-item {
            margin-bottom: 0;
          }
          .nav-link {
            flex-direction: column;
            gap: 0.2rem;
            padding: 0.5rem;
          }
          .nav-link i {
            margin-right: 0;
            font-size: 1.4rem;
          }
          .nav-link span {
            font-size: 0.7rem;
          }
          .sidebar.collapsed .nav-link span,
          .sidebar.collapsed .nav-link i {
            display: block;
            margin-right: 0;
          }

          .main-content {
              padding: 1rem;
              padding-bottom: 80px; /* Space for bottom nav */
              height: calc(100vh - 60px);
          }
          
          .page-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
          }

          .charts-grid {
            grid-template-columns: 1fr;
          }
      }
    </style>
</head>
<body>
    <div id="spinner" class="spinner-overlay" style="display: none;">
        <div class="spinner"></div>
    </div>

    <div id="login-screen">
        <div class="login-container">
            <h1><i class="fas fa-leaf"></i> AgroVetor</h1>
            <p>Faça login para continuar</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn-primary">Entrar</button>
                <a href="#" id="forgot-password-link">Esqueceu a senha?</a>
                <p id="login-error"></p>
            </form>
        </div>
    </div>

    <div id="app-container" class="container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-leaf"></i>
                    <span class="logo-text">AgroVetor</span>
                </div>
                <button id="toggle-sidebar-btn"><i class="fas fa-bars"></i></button>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#dashboard" class="nav-link active" data-section="dashboard-section"><i class="fas fa-chart-pie"></i> <span>Dashboard</span></a>
                </li>
                <li class="nav-item">
                    <a href="#lancamentos" class="nav-link" data-section="lancamentos-section"><i class="fas fa-edit"></i> <span>Lançamentos</span></a>
                </li>
                <li class="nav-item">
                    <a href="#relatorios" class="nav-link" data-section="relatorios-section"><i class="fas fa-file-alt"></i> <span>Relatórios</span></a>
                </li>
                <li class="nav-item" id="cadastros-nav-item" style="display: none;">
                    <a href="#cadastros" class="nav-link" data-section="cadastros-section"><i class="fas fa-cogs"></i> <span>Cadastros</span></a>
                </li>
            </ul>
            <div class="user-profile">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar-initials"></div>
                    <div class="user-details">
                        <h4 id="user-display-name"></h4>
                        <p id="user-role"></p>
                    </div>
                </div>
                <button id="logout-btn"><i class="fas fa-sign-out-alt"></i> <span>Sair</span></button>
            </div>
        </nav>

        <main class="main-content">
            <!-- Seção Dashboard -->
            <section id="dashboard-section" class="content-section active">
                <!-- MÓDULO DE SELEÇÃO -->
                <div id="dashboard-module-selection" class="dashboard-module-selection">
                    <div class="module-card" data-module="broca">
                        <i class="fas fa-bug"></i>
                        <h3>Broca</h3>
                        <p>Análise de infestação da broca-da-cana.</p>
                    </div>
                    <div class="module-card" data-module="perda">
                        <i class="fas fa-chart-line"></i>
                        <h3>Perdas</h3>
                        <p>Monitoramento de perdas na colheita.</p>
                    </div>
                    <div class="module-card" data-module="aerea">
                        <i class="fas fa-plane-departure"></i>
                        <h3>Aplicação Aérea</h3>
                        <p>Dados de aplicações e maturadores.</p>
                    </div>
                </div>

                <!-- DASHBOARD DE BROCA -->
                <div id="dashboard-broca" class="dashboard-module-view">
                    <div class="dashboard-header">
                        <button class="btn-secondary back-btn"><i class="fas fa-arrow-left"></i> Voltar</button>
                        <h2><i class="fas fa-bug"></i> Dashboard de Broca</h2>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h3>Top 10 Fazendas com Maior Índice de Broca</h3>
                            <canvas id="brocaTopFarmsChart"></canvas>
                            <button class="expand-chart-btn" data-chart="brocaTopFarmsChart"><i class="fas fa-expand"></i></button>
                        </div>
                        <div class="chart-container">
                            <h3>Índice de Broca (Mês a Mês)</h3>
                            <canvas id="brocaMonthlyChart"></canvas>
                            <button class="expand-chart-btn" data-chart="brocaMonthlyChart"><i class="fas fa-expand"></i></button>
                        </div>
                        <div class="chart-container">
                            <h3>Local de Infestação da Broca</h3>
                            <canvas id="brocaLocationChart"></canvas>
                            <button class="expand-chart-btn" data-chart="brocaLocationChart"><i class="fas fa-expand"></i></button>
                        </div>
                        <div class="chart-container">
                            <h3>Área Total Avaliada (ha)</h3>
                            <h2 id="brocaTotalArea" style="text-align: center; font-size: 2.5rem; margin-top: 2rem;">-</h2>
                        </div>
                    </div>
                </div>

                <!-- DASHBOARD DE PERDAS -->
                <div id="dashboard-perda" class="dashboard-module-view">
                    <div class="dashboard-header">
                        <button class="btn-secondary back-btn"><i class="fas fa-arrow-left"></i> Voltar</button>
                        <h2><i class="fas fa-chart-line"></i> Dashboard de Perdas</h2>
                    </div>
                    <div class="charts-grid">
                         <div class="chart-container">
                            <h3>Top 10 Fazendas com Maiores Perdas</h3>
                            <canvas id="perdaTopFarmsChart"></canvas>
                            <button class="expand-chart-btn" data-chart="perdaTopFarmsChart"><i class="fas fa-expand"></i></button>
                        </div>
                        <div class="chart-container">
                            <h3>Perdas por Tipo (kg/ha)</h3>
                            <canvas id="perdaTypeChart"></canvas>
                            <button class="expand-chart-btn" data-chart="perdaTypeChart"><i class="fas fa-expand"></i></button>
                        </div>
                        <div class="chart-container">
                            <h3>Perdas Totais (Mês a Mês)</h3>
                            <canvas id="perdaMonthlyChart"></canvas>
                            <button class="expand-chart-btn" data-chart="perdaMonthlyChart"><i class="fas fa-expand"></i></button>
                        </div>
                         <div class="chart-container">
                            <h3>Perda Total Média (kg/ha)</h3>
                            <h2 id="perdaTotal" style="text-align: center; font-size: 2.5rem; margin-top: 2rem;">-</h2>
                        </div>
                    </div>
                </div>

                <!-- DASHBOARD DE APLICAÇÃO AÉREA -->
                <div id="dashboard-aerea" class="dashboard-module-view">
                     <div class="dashboard-header">
                        <button class="btn-secondary back-btn"><i class="fas fa-arrow-left"></i> Voltar</button>
                        <h2><i class="fas fa-plane-departure"></i> Dashboard de Aplicação Aérea</h2>
                    </div>
                    <div class="card">
                        <p>Os gráficos e análises para este módulo estarão disponíveis em breve.</p>
                    </div>
                </div>
            </section>

            <!-- Seção Lançamentos -->
            <section id="lancamentos-section" class="content-section">
                 <div class="page-header">
                    <h1>Lançamentos de Inspeção</h1>
                    <div class="header-actions">
                        <button id="add-lancamento-btn" class="btn-primary"><i class="fas fa-plus"></i> Novo Lançamento</button>
                    </div>
                </div>
                <div class="card">
                    <div class="table-container">
                        <table id="lancamentos-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Fazenda</th>
                                    <th>Talhão</th>
                                    <th>Variedade</th>
                                    <th>I.I. (%)</th>
                                    <th>Perda (kg/ha)</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Linhas da tabela serão inseridas aqui via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Seção Relatórios -->
            <section id="relatorios-section" class="content-section">
                <div class="page-header">
                    <h1>Relatórios</h1>
                </div>
                <div class="card">
                    <h2>Relatório de Inspeção</h2>
                    <p>Gere relatórios detalhados de inspeção em formato PDF ou CSV.</p>
                    <form id="report-form-inspecao" class="form-grid" style="margin-top: 1.5rem;">
                        <div class="form-group">
                            <label for="report-start-date-inspecao">Data Inicial</label>
                            <input type="date" id="report-start-date-inspecao" required>
                        </div>
                        <div class="form-group">
                            <label for="report-end-date-inspecao">Data Final</label>
                            <input type="date" id="report-end-date-inspecao" required>
                        </div>
                    </form>
                     <div class="form-actions">
                        <button type="button" id="generate-pdf-inspecao" class="btn-primary"><i class="fas fa-file-pdf"></i> Gerar PDF</button>
                        <button type="button" id="generate-csv-inspecao" class="btn-secondary"><i class="fas fa-file-csv"></i> Gerar CSV</button>
                    </div>
                </div>
                <div class="card">
                    <h2>Relatório de Planeamento de Colheita</h2>
                    <p>Gere relatórios de planeamento de colheita.</p>
                    <form id="report-form-colheita" class="form-grid" style="margin-top: 1.5rem;">
                         <div class="form-group">
                            <label for="plan-select">Selecione o Plano</label>
                            <select id="plan-select" required></select>
                        </div>
                    </form>
                    <div id="colheita-columns-selector" class="form-group" style="margin-top: 1rem; display: none;">
                        <label>Selecione as colunas para incluir:</label>
                        <!-- Checkboxes serão inseridos aqui -->
                    </div>
                     <div class="form-actions">
                        <button type="button" id="generate-pdf-colheita" class="btn-primary" disabled><i class="fas fa-file-pdf"></i> Gerar PDF</button>
                        <button type="button" id="generate-csv-colheita" class="btn-secondary" disabled><i class="fas fa-file-csv"></i> Gerar CSV</button>
                    </div>
                </div>
            </section>
            
            <!-- Seção Cadastros -->
            <section id="cadastros-section" class="content-section">
                <div class="page-header">
                    <h1>Cadastros</h1>
                </div>
                <div class="card">
                    <!-- Conteúdo de Cadastros (Fazendas, Talhões, etc.) -->
                    <p>Gerencie aqui os cadastros básicos do sistema.</p>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Modais -->
    <div id="lancamento-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="lancamento-modal-title">Novo Lançamento</h2>
                <button id="lancamento-modal-close-btn" class="modal-close-btn">&times;</button>
            </div>
            <form id="lancamento-form">
                <input type="hidden" id="lancamento-id">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="data">Data</label>
                        <input type="date" id="data" required>
                    </div>
                    <div class="form-group">
                        <label for="id_fazenda">Fazenda</label>
                        <select id="id_fazenda" required></select>
                    </div>
                    <div class="form-group">
                        <label for="id_talhao">Talhão</label>
                        <select id="id_talhao" required></select>
                    </div>
                     <div class="form-group">
                        <label for="id_variedade">Variedade</label>
                        <select id="id_variedade" required></select>
                    </div>
                    <div class="form-group">
                        <label for="idade">Idade (meses)</label>
                        <input type="number" id="idade" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="tch_estimado">TCH Estimado</label>
                        <input type="number" id="tch_estimado" step="0.01">
                    </div>
                </div>
                <hr style="margin: 1.5rem 0;">
                <h4>Análise de Broca</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="broca_amostras">Nº de Amostras</label>
                        <input type="number" id="broca_amostras" min="0">
                    </div>
                    <div class="form-group">
                        <label for="broca_total_colmos">Total de Colmos</label>
                        <input type="number" id="broca_total_colmos" min="0">
                    </div>
                    <div class="form-group">
                        <label for="broca_colmos_furados">Colmos Furados</label>
                        <input type="number" id="broca_colmos_furados" min="0">
                    </div>
                    <div class="form-group">
                        <label for="broca_base">Danos na Base</label>
                        <input type="number" id="broca_base" min="0">
                    </div>
                    <div class="form-group">
                        <label for="broca_meio">Danos no Meio</label>
                        <input type="number" id="broca_meio" min="0">
                    </div>
                    <div class="form-group">
                        <label for="broca_topo">Danos no Topo</label>
                        <input type="number" id="broca_topo" min="0">
                    </div>
                </div>
                 <hr style="margin: 1.5rem 0;">
                <h4>Análise de Perdas</h4>
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="perda_ponteiro">Ponteiro (kg/ha)</label>
                        <input type="number" id="perda_ponteiro" step="0.01">
                    </div>
                     <div class="form-group">
                        <label for="perda_rebolo">Rebolo (kg/ha)</label>
                        <input type="number" id="perda_rebolo" step="0.01">
                    </div>
                     <div class="form-group">
                        <label for="perda_tolete">Tolete (kg/ha)</label>
                        <input type="number" id="perda_tolete" step="0.01">
                    </div>
                     <div class="form-group">
                        <label for="perda_lasca">Lasca (kg/ha)</label>
                        <input type="number" id="perda_lasca" step="0.01">
                    </div>
                     <div class="form-group">
                        <label for="perda_pedaco">Pedaço (kg/ha)</label>
                        <input type="number" id="perda_pedaco" step="0.01">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="lancamento-modal-cancel-btn" class="btn-secondary">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="confirm-delete-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirmar Exclusão</h2>
            </div>
            <p>Tem certeza de que deseja excluir este item? Esta ação não pode ser desfeita.</p>
            <div class="modal-footer">
                <button id="cancel-delete-btn" class="btn-secondary">Cancelar</button>
                <button id="confirm-delete-btn" class="btn-danger">Excluir</button>
            </div>
        </div>
    </div>

    <div id="forgot-password-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Redefinir Senha</h2>
                <button id="forgot-password-close-btn" class="modal-close-btn">&times;</button>
            </div>
            <p>Digite seu e-mail e enviaremos um link para você redefinir sua senha.</p>
            <form id="forgot-password-form">
                <div class="form-group">
                    <label for="forgot-email">Email</label>
                    <input type="email" id="forgot-email" required>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-primary">Enviar Link</button>
                </div>
            </form>
            <p id="forgot-password-message" style="margin-top: 1rem;"></p>
        </div>
    </div>
    
    <div id="adminPasswordConfirmModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirmação de Administrador</h2>
            </div>
            <p>Para criar um novo usuário, por favor, confirme sua senha de administrador.</p>
            <div class="form-group">
                <label for="adminConfirmPassword">Sua Senha de Administrador:</label>
                <input type="password" id="adminConfirmPassword" required>
            </div>
            <div class="modal-footer">
                <button id="adminPasswordConfirmModalCancelBtn" class="btn-secondary">Cancelar</button>
                <button id="adminPasswordConfirmModalConfirmBtn" class="btn-primary">Confirmar e Criar</button>
            </div>
        </div>
    </div>
    
    <div id="chartModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="chartModalTitle">Gráfico Expandido</h2>
                <button id="chartModalCloseBtn" class="modal-close-btn">&times;</button>
            </div>
            <div id="expandedChartContainer">
                <canvas id="expandedChartCanvas"></canvas>
            </div>
        </div>
    </div>

    <!-- Bibliotecas Externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

    <!-- Script principal da aplicação -->
    <script type="module" src="./app.js"></script>
</body>
</html>
